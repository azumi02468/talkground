(function(e){function r(r){for(var n,a,i=r[0],c=r[1],l=r[2],d=0,p=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(r);while(p.length)p.shift()();return s.push.apply(s,l||[]),t()}function t(){for(var e,r=0;r<s.length;r++){for(var t=s[r],n=!0,i=1;i<t.length;i++){var c=t[i];0!==o[c]&&(n=!1)}n&&(s.splice(r--,1),e=a(a.s=t[0]))}return e}var n={},o={app:0},s=[];function a(r){if(n[r])return n[r].exports;var t=n[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=e,a.c=n,a.d=function(e,r,t){a.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,r){if(1&r&&(e=a(e)),8&r)return e;if(4&r&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)a.d(t,n,function(r){return e[r]}.bind(null,n));return t},a.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(r,"a",r),r},a.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=r,i=i.slice();for(var l=0;l<i.length;l++)r(i[l]);var u=c;s.push([0,"chunk-vendors"]),t()})({0:function(e,r,t){e.exports=t("56d7")},"034f":function(e,r,t){"use strict";var n=t("85ec"),o=t.n(n);o.a},5404:function(e,r,t){},"56d7":function(e,r,t){"use strict";t.r(r);t("e260"),t("e6cf"),t("cca6"),t("a79d");var n=t("2b0e"),o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{attrs:{id:"app"}},[t("HelloWorld",{attrs:{msg:"Talkground"}})],1)},s=[],a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"hello"},[t("h1",[e._v(e._s(e.msg))]),t("div",{staticClass:"room"},[t("div",[e._v(" 自分を画面に表示する："),t("input",{directives:[{name:"model",rawName:"v-model",value:e.selfDisp,expression:"selfDisp"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selfDisp)?e._i(e.selfDisp,null)>-1:e.selfDisp},on:{change:function(r){var t=e.selfDisp,n=r.target,o=!!n.checked;if(Array.isArray(t)){var s=null,a=e._i(t,s);n.checked?a<0&&(e.selfDisp=t.concat([s])):a>-1&&(e.selfDisp=t.slice(0,a).concat(t.slice(a+1)))}else e.selfDisp=o}}}),t("br"),e._v(" マイクのオン／オフを切り替える："),t("input",{directives:[{name:"model",rawName:"v-model",value:e.microphoneFlg,expression:"microphoneFlg"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.microphoneFlg)?e._i(e.microphoneFlg,null)>-1:e.microphoneFlg},on:{change:[function(r){var t=e.microphoneFlg,n=r.target,o=!!n.checked;if(Array.isArray(t)){var s=null,a=e._i(t,s);n.checked?a<0&&(e.microphoneFlg=t.concat([s])):a>-1&&(e.microphoneFlg=t.slice(0,a).concat(t.slice(a+1)))}else e.microphoneFlg=o},e.changeMicrophone]}}),t("br"),e._v(" 画面のオン／オフを切り替える："),t("input",{directives:[{name:"model",rawName:"v-model",value:e.videoFlg,expression:"videoFlg"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.videoFlg)?e._i(e.videoFlg,null)>-1:e.videoFlg},on:{change:[function(r){var t=e.videoFlg,n=r.target,o=!!n.checked;if(Array.isArray(t)){var s=null,a=e._i(t,s);n.checked?a<0&&(e.videoFlg=t.concat([s])):a>-1&&(e.videoFlg=t.slice(0,a).concat(t.slice(a+1)))}else e.videoFlg=o},e.changeVideo]}}),t("br"),t("video",{directives:[{name:"show",rawName:"v-show",value:e.selfDisp,expression:"selfDisp"}],ref:"jsLocalStream",attrs:{id:"jsLocalStream",muted:"",playsinline:""},domProps:{muted:!0}}),t("div",[t("p",[e._v("任意のルーム名を入力してください。")]),e.errors.length?t("p",{staticClass:"errMsg"},[e._v(e._s(e.errors[0]))]):e._e(),e._v(" ルーム名："),t("input",{directives:[{name:"model",rawName:"v-model",value:e.jsRoomId,expression:"jsRoomId"}],attrs:{type:"text",placeholder:"Room Name",id:"jsRoomId",disabled:e.joinFlg},domProps:{value:e.jsRoomId},on:{input:function(r){r.target.composing||(e.jsRoomId=r.target.value)}}})]),t("button",{attrs:{id:"jsJoinTrigger",disabled:e.joinFlg},on:{click:e.join}},[e._v("入室")]),t("button",{ref:"jsLeaveTrigger",attrs:{id:"jsLeaveTrigger",disabled:!e.joinFlg}},[e._v("退出")])]),t("div",{ref:"jsRemoteStreams",staticClass:"remoteStreams",attrs:{id:"jsRemoteStreams"}}),t("div",[t("div",{attrs:{id:"messages"}},e._l(e.messageList,(function(r,n){return t("div",{key:n,style:{textAlign:r.align}},[e._v(e._s(r.message))])})),0),t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.jsLocalText,expression:"jsLocalText"}],attrs:{type:"text",id:"jsLocalText",disabled:!e.joinFlg},domProps:{value:e.jsLocalText},on:{input:function(r){r.target.composing||(e.jsLocalText=r.target.value)}}})]),t("button",{ref:"jsSendTrigger",attrs:{id:"jsSendTrigger",disabled:!e.joinFlg}},[e._v("メッセージ送信")])])])])},i=[],c=(t("99af"),t("4160"),t("a630"),t("3ca3"),t("498a"),t("159b"),t("96cf"),t("1da1")),l=t("0b69"),u=t.n(l),d={name:"HelloWorld",props:{msg:String},data:function(){return{jsRoomId:"",localStream:{},jsLocalText:"",errors:[],joinFlg:!1,messageList:[],selfDisp:!1,microphoneFlg:!0,videoFlg:!0}},methods:{join:function(){var e=this;if(""===e.jsRoomId.trim())return e.errors.push("ルーム名は必須です。"),void(e.jsRoomId="");if(p.open){var r=p.joinRoom(e.jsRoomId,{mode:"mesh",stream:e.localStream});r.once("open",(function(){e.messageList.push({message:"=== "+p.id+" You joined ===\n",align:"left"}),e.joinFlg=!0})),r.on("peerJoin",(function(r){e.messageList.push({message:"=== ".concat(r," joined ===\n"),align:"right"})})),r.on("stream",function(){var r=Object(c["a"])(regeneratorRuntime.mark((function r(t){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=document.createElement("video"),n.srcObject=t,n.playsInline=!0,n.setAttribute("data-peer-id",t.peerId),e.$refs.jsRemoteStreams.append(n),r.next=7,n.play().catch(console.error);case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),r.on("data",(function(r){var t=r.data,n=r.src;e.messageList.push({message:"".concat(n,": ").concat(t,"\n"),align:"right"})})),r.on("peerLeave",(function(r){var t=e.$refs.jsRemoteStreams.querySelector("[data-peer-id=".concat(r,"]"));t.srcObject.getTracks().forEach((function(e){return e.stop()})),t.srcObject=null,t.remove(),e.messageList.push({message:"=== ".concat(r," left ===\n"),align:"right"})})),r.once("close",(function(){e.$refs.jsSendTrigger.removeEventListener("click",t),e.messageList.push({message:"=== "+p.id+" You left ===\n",align:"left"}),Array.from(e.$refs.jsRemoteStreams.children).forEach((function(e){e.srcObject.getTracks().forEach((function(e){return e.stop()})),e.srcObject=null,e.remove()})),e.joinFlg=!1})),e.$refs.jsSendTrigger.addEventListener("click",t),e.$refs.jsLeaveTrigger.addEventListener("click",(function(){return r.close()}),{once:!0})}else alert("接続を確立することができませんでした。再度お試しください。");function t(){e.jsLocalText.trim().length>50?alert("メッセージは50文字までにしてください。"):""!==e.jsLocalText.trim()&&(r.send(e.jsLocalText.trim()),e.messageList.push({message:"".concat(p.id,": ").concat(e.jsLocalText.trim(),"\n"),align:"left"}),e.jsLocalText="")}},changeMicrophone:function(){this.localStream.getAudioTracks()[0].enabled=this.microphoneFlg},changeVideo:function(){this.localStream.getVideoTracks()[0].enabled=this.videoFlg}},mounted:function(){var e=this;(function(){var r=Object(c["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t=e.$refs.jsLocalStream,r.next=3,navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).catch(console.error);case 3:return e.localStream=r.sent,t.srcObject=e.localStream,r.next=7,t.play().catch(console.error);case 7:p.on("error",console.error);case 8:case"end":return r.stop()}}),r)})));function t(){return r.apply(this,arguments)}return t})()()}},p=new u.a({key:"59093eb6-f094-476c-af62-ab068434ec23"}),m=d,f=(t("ac70"),t("2877")),g=Object(f["a"])(m,a,i,!1,null,"6f53a2c8",null),v=g.exports,h={name:"App",components:{HelloWorld:v}},j=h,b=(t("034f"),Object(f["a"])(j,o,s,!1,null,null,null)),y=b.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(y)}}).$mount("#app")},"85ec":function(e,r,t){},ac70:function(e,r,t){"use strict";var n=t("5404"),o=t.n(n);o.a}});
//# sourceMappingURL=app.f9c7a672.js.map